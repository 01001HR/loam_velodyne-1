function r = getJPlane(tx,ty,tz,phi,theta,psi,x,y,z,x_i,y_i,z_i,x_j,y_j,z_j,x_l,y_l,z_l)
%GETJPLANE Summary of this function goes here
%   Detailed explanation goes here
% r(1) = (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
% r(2) = -(abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
% r(3) = (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
% r(4) = (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) + x*cos(phi)*cos(theta)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) - z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + x*cos(theta)*sin(phi))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
% r(5) = (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*cos(psi)*cos(theta)*sin(phi) - x*sin(phi)*sin(theta) + y*cos(theta)*sin(phi)*sin(psi)) + ((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(x*cos(theta) + z*cos(psi)*sin(theta) + y*sin(psi)*sin(theta)) - ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(z*cos(phi)*cos(psi)*cos(theta) - x*cos(phi)*sin(theta) + y*cos(phi)*cos(theta)*sin(psi))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
% r(6) = -(abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(y*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + z*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta))) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) + z*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))) + (y*cos(psi)*cos(theta) - z*cos(theta)*sin(psi))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2));
r = [ (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2)), -(abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2)), (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j)))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2)), (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) + x*cos(phi)*cos(theta)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) - z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + x*cos(theta)*sin(phi))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2)), (abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*cos(psi)*cos(theta)*sin(phi) - x*sin(phi)*sin(theta) + y*cos(theta)*sin(phi)*sin(psi)) + ((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(x*cos(theta) + z*cos(psi)*sin(theta) + y*sin(psi)*sin(theta)) - ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(z*cos(phi)*cos(psi)*cos(theta) - x*cos(phi)*sin(theta) + y*cos(phi)*cos(theta)*sin(psi))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2)), -(abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(y*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + z*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta))) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) + z*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))) + (y*cos(psi)*cos(theta) - z*cos(theta)*sin(psi))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))))/((abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))^2)^(1/2)*(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)^(1/2))];
r = [ (2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j)))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2), -(2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j)))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2), (2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j)))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2), (2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) + x*cos(phi)*cos(theta)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) - z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + x*cos(theta)*sin(phi))))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2), (2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(z*cos(psi)*cos(theta)*sin(phi) - x*sin(phi)*sin(theta) + y*cos(theta)*sin(phi)*sin(psi)) + ((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(x*cos(theta) + z*cos(psi)*sin(theta) + y*sin(psi)*sin(theta)) - ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(z*cos(phi)*cos(psi)*cos(theta) - x*cos(phi)*sin(theta) + y*cos(phi)*cos(theta)*sin(psi))))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2), -(2*abs(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*sign(((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))*(tz + z_i + x*sin(theta) - z*cos(psi)*cos(theta) - y*cos(theta)*sin(psi)) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(tx + x_i + y*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - z*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - x*cos(phi)*cos(theta)) - ((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(ty + y_i - y*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) + z*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) - x*cos(theta)*sin(phi)))*(((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))*(y*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + z*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta))) + ((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))*(y*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) + z*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))) + (y*cos(psi)*cos(theta) - z*cos(theta)*sin(psi))*((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))))/(abs((x_i - x_j)*(y_i - y_l) - (x_i - x_l)*(y_i - y_j))^2 + abs((x_i - x_j)*(z_i - z_l) - (x_i - x_l)*(z_i - z_j))^2 + abs((y_i - y_j)*(z_i - z_l) - (y_i - y_l)*(z_i - z_j))^2)];
end

